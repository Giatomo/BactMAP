\name{plotOverlay}
\alias{plotOverlay}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
Display spot- and/or object-localization of different color channels and/or experimental conditions in one plot.
}
\description{
%%  ~~ A concise (1-5 lines) description of what the function does. ~~
}
\usage{
plotOverlay(meshdata,
            spotdata,
            objectdata,
            by = "both",
            type = "all",
            quantiles = 1,
            quantiles_by = "max.length",
            mag,
            objectcolor = c("#E69F00", "#56B4E9", "#009E73", "#F0E442"),
            spotcolor = c("#0072B2", "#D55E00", "#CC79A7", "000000"),
            histogram_outline = NA,
            his_scales = "free")
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{meshdata}{
  A \code{mesh} dataframe generated by combining dataframes with the function \code{\link{combineDataframes}}. Optional.
}
  \item{spotdata}{
  A \code{spot} dataframe generated by combining dataframes with the function \code{\link{combineDataframes}}. Optional.
}
  \item{objectdata}{
  A \code{object} dataframe generated by combining dataframes with the function \code{\link{combineDataframes}}. Optional.
}
  \item{by}{
  Either "both", "channel" or "condition", indicating which variables are to be plotted.
}
  \item{type}{
  The type of output plot. Options are: "histogram", "length", "width", "projection" or "all". Examples of each plot are given below.
}
  \item{quantiles and quantiles_by}{
  When "projection" or "all" is chosen, the cells can be split into groups by \code{quantiles_by}: one of the other columns existing in each dataset (default = \code{max.length}). Default for \code{quantiles} = \code{1}, so no grouping.
}
  \item{mag}{
  magnification convertion factor, needed when cell values are not yet converted to microns. See \code{\link{getPixels2um}}.
}
  \item{objectcolor}{
  Indicates the color(s) of the objects (if included). Default colorset is a range of 4 colors ("#E69F00", "#56B4E9", "#009E73" and "#F0E442").
}
  \item{spotcolor}{
  Indicates the color(s) of the spot data (if included). Default colorset is a range of 4 colors ("#0072B2", "#D55E00", "#CC79A7" and "000000").
}
  \item{histogram_outline}{
  By default, the histograms displayed have no outlines. Indicate a hex value or a colorname to change this.
}
  \item{his_scales}{
  Inherited from ggplot2::geom_facet_grid(): when cells are grouped into different groups, by default, the histograms y-axis is scaled free per group. Setting \code{his_scales} to "fixed" will make the scale the same for each group.
}
}
\details{
%%  ~~ If necessary, more details than the description above ~~
}
\value{
A plot or a list of plots:

\item{histogram}{
  Histogram plot of the localization distribution, if \code{quantiles} are set, grouped by \code{by_quantiles}.
}
\item{length}{
  Dotplot showing the localization of the spots and/or objects on the cell's length axis on the y-axis, and the cells ordered by cell length on the x-axis.
}
\item{width}{
  Dotplot showing the localization of the spots and/or objects on the cell's width axis on the y-axis, and the cells ordered by cell length on the x-axis.
}
\item{projection}{
  Cell projections showing the relative object localization, spot localization and cell shape; if \code{quantiles} are set, grouped by \code{by_quantiles}.
  }
}
\references{
%% ~put references to the literature/web site here ~
}
\author{
%%  ~~who you are~~
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{

##get data from BactMAP package
#condition one: wild type
WT <- system.file("extdata", "WT_obj.txt", package = "bactMAP")
#condition 2: dmapZ
DM <- system.file("extdata", "DmapZ_obj.txt", package="bactMAP")

##extract data using extr_Oufti
WT_extr <- extr_Oufti(WT, mag="100x_DVMolgen")
DM_extr <- extr_Oufti(DM, mag="100x_DVMolgen")

#combine Mesh and Object dataframes
comboMesh <- combineDataframes(list(WT_extr$mesh, DM_extr$mesh), listofconditions=list("WildType", "DeltaMapZ"))
comboObjects <- combineDataframes(list(WT_extr$object_relative, DM_extr$object_relative), listofconditions=list("WildType", "DeltaMapZ"))

##plot projection of 4 quartiles
plotOverlay(meshdata=comboMesh,
            objectdata=comboObjects,
            quantiles=4,
            type="projection")


}
